var b=null;function f(){this.l={}}f.prototype.B=function(a,c){this.l[a]||(this.l[a]=[]);this.l[a].push(c)};f.prototype.V=f.prototype.B;f.prototype.e=function(){var a=Array.prototype.slice.call(arguments),c=a.shift();if(this.l[c])for(var d=0;d<this.l[c].length;d++)this.l[c][d].apply(this,a)};
function g(a){g.d.constructor.call(this);this.options=g.p.D({C:{host:document.location.hostname,port:document.location.port||4E3}},a);this.da={};this.fa=g.S.L;this.ea=[];this.W=new g.N(this);this.U=b;if(this.options.C.constructor==Object)this.H=new g.b(this.options.C.host,this.options.C.port),i(this.H),this.H.s(this);else debugger;var c=this;this.V(g.b.F,function(a){var e=c.W,a=JSON.parse(a);if(a.g==void 0||a.U==void 0||a.id==void 0)e.a.log("Beseda receive incorrect message",a),e.a.e("error",a);else if(a.g.indexOf("/meta/")==
0){var h=a.g.substr(6);!h in["connect","error","subscribe","unsubscribe"]&&(e.a.log("Unsupported meta channel "+a.g),e.a.e("error",a));e["_"+h].call(e,a)}else"successful"in a?(e.a.e("message:"+a.g+":"+a.id,a.error,a),a.ha?e.a.log("Beseda publish to "+a.g,a):(e.a.log("Beseda publish request declined",a),e.a.e("error",a))):(e.a.log("Beseda get a new message from "+a.g,a),e.a.e("message:"+a.g,a.data,a),e.a.e("message",a.g,a.data,a))})}j();
g.prototype.log=function(){"console"in window&&"log"in console&&console.log.apply(console,arguments)};g.S={L:0,CONNECTING:1,X:2};g.aa=0;function j(){function a(){}var c=g,d=f;a.prototype=d.prototype;c.prototype=new a;c.prototype.constructor=c;c.d=c.prototype.d=d.prototype;a=b}
g.p={ia:function(){for(var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),c=[],d=0;d<22;d++)c[d]=a[0|Math.random()*64];return c.join("")},ga:function(a){return this.D({},a)},D:function(a,c){for(var d in c)try{a[d]=c[d].constructor==Object?this.D(a[d],c[d]):c[d]}catch(e){a[d]=c[d]}return a},r:function(a,c){function d(){}d.prototype=c.prototype;a.prototype=new d;a.prototype.constructor=a;a.d=a.prototype.d=c.prototype;d=b}};g.N=function(a){this.a=a};
g.b=function(a,c){this.$=a;this.ba=c;this.u=this.n=b};g.b.M="io_connect";g.b.F="io_message";g.b.Y="io_disconnect";g.b.Z="io_error";function i(a){var c=new g.c;a.n=c;a.u&&a.n.s(a.u)}g.b.prototype.s=function(a){this.n?this.n.s(a):this.u=a};g.b.prototype.send=function(a){this.n.send(a)};g.h=function(){g.h.d.constructor.call(this);this.url=b;this.method="GET";this.data=b};g.p.r(g.h,f);
g.h.prototype.send=function(a){if(a)this.url=a;a=this.url;c!=b&&c.abort();var c=+"\u000b1"?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),d=this;c.onreadystatechange=function(){var a=c;a.readyState===4&&(d.e("ready",a.responseText),a.abort())};this.method==="GET"&&this.data&&(a+=(a.indexOf("?")===-1?"?":"&")+this.data);c.open(this.method,encodeURI(a),!0);a=b;if(this.method==="POST")a=this.data,c.setRequestHeader("Content-Type","application/x-www-form-urlencoded");c.send(a)};
g.f=function(){g.f.d.constructor.call(this);this.url=b;this.G=g.f.R++;this.j=b;var a=this;g.f.O[this.G]=function(c){document.body.removeChild(a.j);a.j=b;a.e("ready",c)}};g.p.r(g.f,f);g.f.O=[];g.f.R=0;g.f.prototype.send=function(a){if(a)this.url=a;if(!this.j)a=this.url,a+=(a.indexOf("?")===-1?"?":"&")+"callback=Beseda.JSONPRequest.__callbacks["+this.G+"]&"+(new Date).getTime(),this.j=document.createElement("script"),this.j.src=a,this.j.async="async",document.body.appendChild(this.j)};
g.i=function(){this.q=this.o=this.J=this.T=b;this.v=[]};g.i.K="|";g.i.prototype.send=function(){throw Error("Abstract method calling.");};g.i.prototype.s=function(a){this.q=a};g.i.prototype.z=function(a){this.o=a;for(this.q&&this.q.e(g.b.M,this.o);this.v.length;)this.send(this.v.shift())};g.i.prototype.A=function(a){if(a&&a.length>0)for(a=a.split(g.i.K);a.length;)this.q.e(g.b.F,a.shift())};
g.c=function(){g.c.d.constructor.call(this);this.J="/long-polling";this.k=this.m=this.w=b;this.I();var a=this;this.P=function(c){a.z(c)};this.Q=function(c){a.A(c)};this.w.B("ready",this.P);this.m.B("ready",this.Q)};g.p.r(g.c,g.i);g.c.prototype.I=function(){this.w=new g.h;this.m=new g.h;this.k=new g.h;this.k.method="POST"};g.c.prototype.z=function(a){this.k.url=this.m.url=this.T+"/"+a;g.c.d.z.call(this,a);this.o&&this.m.send()};g.c.prototype.A=function(a){g.c.d.A.call(this,a);this.o&&this.m.send()};
g.c.prototype.send=function(a){this.o?(this.k.data=a,this.k.send()):this.v.push(a)};g.t=function(){g.t.d.constructor.call(this);this.ca="jsonp";this.J="/jsonp-polling"};g.p.r(g.t,g.c);g.t.prototype.I=function(){this.w=new g.f;this.m=new g.f;this.k=new g.h;this.k.method="POST"};